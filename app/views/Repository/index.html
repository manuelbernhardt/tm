#{extends 'main.html' /}
#{set title:'Test Scripts repository' /}


<div class="container">
  <div class="left_tree">
    <div id="actions">
      <button id="create_folder">Folder</button>
      <button id="create_script">Test Script</button>
      <button id="remove">Remove</button>
    </div>
    #{box 'Test Script Repository'}
    <div id="repositoryTree" class="tree" style="border-style:none;"></div>
    #{/box}
  </div>
  <div class="right_tree">
    <div id="scriptDetails">No script selected</div>
  </div>
</div>


#{set 'moreScripts'}
<script src="@{'/public/javascripts/repositoryTree.js'}" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">

  $(document).ready(function () {
    repositoryTree('@{TMTreeController.getChildren()}');
    #{tree.common id:"repositoryTree", controller:"TMTreeController" /}
    #{tree.selectionListener treeId:"repositoryTree", type:"scriptNode", types:["default", 'script'], action:@Repository.content(), targetId:"scriptDetails" /}

    /** button initialisation **/
    $(function () {
      $("#create_folder").button({icons: {primary: 'ui-icon-plus'}}).click(function () {
        $("#repositoryTree").jstree("create", null, "last", {attr:{"rel":"scriptFolder"}});
      })
      $("#create_script").button({icons: {primary: 'ui-icon-plus'}}).click(function () {
        $("#repositoryTree").jstree("create", null, "last", {attr:{"rel":"default"}});
      })
      $("#remove").button({icons: {primary: 'ui-icon-minus'}}).click(function () {
        $("#repositoryTree").jstree("remove", null);
      })
    });

  });

</script>
#{/set}
